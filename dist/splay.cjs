"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});class o{key;parent=null;left=null;right=null;constructor(r){this.key=r}}class n{root=null;NodeCtor;compare;constructor(r,t){this.NodeCtor=r,this.compare=t||((e,i)=>e>i?1:e<i?-1:0)}pushup(r){r&&r.pushup()}rotate(r){const t=r.parent,e=t.parent,i=t.left===r;e&&(e.left===t?e.left=r:e.right=r),r.parent=e,i?(t.left=r.right,t.left&&(t.left.parent=t),r.right=t):(t.right=r.left,t.right&&(t.right.parent=t),r.left=t),t.parent=r,this.pushup(t),this.pushup(r)}splay(r,t=null){for(;r.parent!==t;){const e=r.parent,i=e.parent;i!==t&&(e.left===r==(i.left===e)?this.rotate(e):this.rotate(r)),this.rotate(r)}t===null&&(this.root=r)}insert(r){if(!this.root)return this.root=new this.NodeCtor(r),this.pushup(this.root),this.root;let t=this.root;for(;;){const e=this.compare(r,t.key);if(e===0)return this.splay(t),t;const i=e<0?t.left:t.right;if(!i){const s=new this.NodeCtor(r);return s.parent=t,e<0?t.left=s:t.right=s,this.splay(s),s}t=i}}find(r){if(!this.root)return null;let t=this.root,e=t;for(;t;){e=t;const i=this.compare(r,t.key);if(i===0)return this.splay(t),t;t=i<0?t.left:t.right}return this.splay(e),null}findMax(){if(!this.root)return null;let r=this.root;for(;r.right;)r=r.right;return this.splay(r),r}findMin(){if(!this.root)return null;let r=this.root;for(;r.left;)r=r.left;return this.splay(r),r}delete(r){const t=this.find(r);if(!t||this.compare(t.key,r)!==0)return!1;if(!t.left)this.root=t.right,this.root&&(this.root.parent=null);else if(!t.right)this.root=t.left,this.root&&(this.root.parent=null);else{const e=t.right;e.parent=null,this.root=t.left,this.root.parent=null,this.findMax(),this.root.right=e,e.parent=this.root,this.pushup(this.root)}return!0}rank(r){if(!this.root)return 0;const t=this.find(r);return t&&this.compare(t.key,r)===0?(t.left?t.left.size:0)+1:0}kth(r){let t=this.root;for(;t;){const e=t.left?t.left.size:0;if(r===e+1)return this.splay(t),t;r<=e?t=t.left:(r-=e+1,t=t.right)}return null}prev(r){let t=this.root,e=null;for(;t;)this.compare(t.key,r)<0?(e=t,t=t.right):t=t.left;return e&&this.splay(e),e}next(r){let t=this.root,e=null;for(;t;)this.compare(t.key,r)>0?(e=t,t=t.left):t=t.right;return e&&this.splay(e),e}join(r){if(!r.root)return;if(!this.root){this.root=r.root,r.root=null;return}const t=this.findMax();t.right=r.root,r.root&&(r.root.parent=t),this.pushup(t),r.root=null}merge(r){if(!r.root)return;const t=e=>{e&&(t(e.left),t(e.right),this.insert(e.key))};t(r.root),r.root=null}}exports.SplayNode=o;exports.SplayTree=n;
